# ๐งพ ะะตะผะพะฝัััะฐัะธะพะฝะฝัะน ัะตัะฒะธั ั Kafka, PostgreSQL ะธ ะบะตัะตะผ

---

## ๐ ะะฑะทะพั

ะัะพััะพะน ะผะธะบัะพัะตัะฒะธั ะฝะฐ Go ั ะฑะฐะทะพะน ะดะฐะฝะฝัั ะธ ะพัะตัะตะดัั ัะพะพะฑัะตะฝะธะน. ะกะตัะฒะธั ะฟะพะปััะฐะตั ะดะฐะฝะฝัะต ะทะฐะบะฐะทะพะฒ ะธะท Kafka, ัะพััะฐะฝัะตั ะธั ะฒ PostgreSQL ะธ ะบััะธััะตั ะฒ ะฟะฐะผััะธ ะดะปั ะฑััััะพะณะพ ะดะพัััะฟะฐ. ะะผะตะตั HTTP-ะธะฝัะตััะตะนั ะดะปั ะฟะพะปััะตะฝะธั ะดะฐะฝะฝัั ะฟะพ `order_uid`.

---

## ๐ ะฃััะฐะฝะพะฒะบะฐ ะธ ะทะฐะฟััะบ

### 1. ะะปะพะฝะธัะพะฒะฐะฝะธะต ัะตะฟะพะทะธัะพัะธั

```bash
git clone git@github.com:zayneshzangar/level0.git
cd level0
```

### 2. ะฃััะฐะฝะพะฒะบะฐ ะทะฐะฒะธัะธะผะพััะตะน

```bash
go mod tidy
```

### 3. ะะฐะฟััะบ Kafka ะธ PostgreSQL + ัะพะทะดะฐะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปั ะธ ะะ

```bash
cd scripts
./script.sh
```

### 4. ะฃะดะฐะปะตะฝะธะต ะธะฝััััะผะตะฝัะพะฒ ะฟะพัะปะต ะทะฐะฒะตััะตะฝะธั ัะฐะฑะพัั

```bash
cd scripts
./script.sh --delete
```

> โ๏ธ **ะัะธะผะตัะฐะฝะธะต:**
> ะัะปะธ ั ะฒะฐั ะตััั ะฝัะถะฝัะต, ะฝะพ ะฝะตะธัะฟะพะปัะทัะตะผัะต Docker-ัะพะผะฐ (`volumes`), ะฝะต ะธัะฟะพะปัะทัะนัะต ะฟะฐัะฐะผะตัั `--delete`.
> ะขะฐะบะถะต ะฒั ะผะพะถะตัะต ะทะฐะบะพะผะผะตะฝัะธัะพะฒะฐัั ัััะพะบั ั ัะดะฐะปะตะฝะธะตะผ `volume` ะฒ ัะบัะธะฟัะต `delete-kafka.sh` ะธ ัะดะฐะปะธัั ัะพะผะฐ ะฒัััะฝัั.
> ะะผะตะฝะฐ ัะพะผะพะฒ Kafka ะณะตะฝะตัะธัััััั ะฐะฒัะพะผะฐัะธัะตัะบะธ, ััะพ ะทะฐัััะดะฝัะตั ะธั ัะดะฐะปะตะฝะธะต ะฟะพ ะฝะฐะทะฒะฐะฝะธั ะฒ ัะบัะธะฟัะต.

---

## ๐ฆ ะะพะฑะฐะฒะปะตะฝะธะต Kafka Topic

### ะัะพะฒะตัะบะฐ ะทะฐะฟััะบะฐ Kafka:

ะะพัะปะต ะทะฐะฟััะบะฐ ัะฑะตะดะธัะตัั, ััะพ Kafka ัะฐะฑะพัะฐะตั ะบะพััะตะบัะฝะพ ะธ ะพะดะธะฝ ะธะท ะฑัะพะบะตัะพะฒ ะฝะฐะทะฝะฐัะตะฝ **ะบะพะฝััะพะปะปะตัะพะผ**:

1. ะะตัะตะนะดะธัะต ะฟะพ ะฐะดัะตัั: [http://localhost:8090](http://localhost:8090)
2. ะ ัะฐะทะดะตะปะต `Dashboard` โ `Brokers` ะฟัะพะฒะตัััะต:

   * ะกะบะพะปัะบะพ ะฑัะพะบะตัะพะฒ ะฐะบัะธะฒะฝะพ.
   * ะะฐะบะพะน ะธะท ะฝะธั ะฒัะฑัะฐะฝ ะบะพะฝััะพะปะปะตัะพะผ (`Controller ID`).

![Kafka UI](./assets/kafka-ui.png)

### ะะพะฑะฐะฒะปะตะฝะธะต `topic`:

```bash
cd scripts
./create-topic.sh
```

---

## ๐งฑ ะััะธัะตะบัััะฐ ะฟัะพะตะบัะฐ

ะัะพะตะบั ะพัะณะฐะฝะธะทะพะฒะฐะฝ ะฟะพ ะฟัะธะฝัะธะฟะฐะผ **ัะธััะพะน ะฐััะธัะตะบัััั**: ัะปะพะธ ัะฐะทะดะตะปะตะฝั ะฟะพ ะพัะฒะตัััะฒะตะฝะฝะพััะธ.

<details>
<summary>ะกัััะบัััะฐ ะฟัะพะตะบัะฐ</summary>

```
โโโ assets
โยย โโโ kafka-ui.png
โโโ cmd
โยย โโโ consumer
โยย โยย โโโ main.go
โยย โโโ producer
โยย     โโโ emulator_producer.go
โโโ config
โยย โโโ config.go
โโโ frontend
โยย โโโ index.html
โยย โโโ script.js
โยย โโโ style.css
โโโ go.mod
โโโ go.sum
โโโ internal
โยย โโโ controller
โยย โยย โโโ http
โยย โยย โยย โโโ v1
โยย โยย โยย     โโโ handler.go
โยย โยย โยย     โโโ router.go
โยย โยย โโโ kafka
โยย โยย     โโโ consumer.go
โยย โโโ entity
โยย โยย โโโ entity.go
โยย โโโ service
โยย โยย โโโ endpoint.go
โยย โยย โโโ service.go
โยย โโโ storage
โยย     โโโ connection.go
โยย     โโโ create_tables.go
โยย     โโโ endpoint.go
โยย     โโโ storage.go
โโโ note.txt
โโโ README.md
โโโ scripts
    โโโ create-db.sh
    โโโ create-topic.sh
    โโโ delete-kafka.sh
    โโโ delete-psql.sh
    โโโ docker-compose-kafka.yaml
    โโโ docker-compose-psql.yaml
    โโโ env.sh
    โโโ run-kafka.sh
    โโโ run-psql.sh
    โโโ script.sh
```

</details>

---

## ๐๏ธ ะขัะตะฑะพะฒะฐะฝะธั

ะฃะฑะตะดะธัะตัั, ััะพ ัััะฐะฝะพะฒะปะตะฝั ัะปะตะดัััะธะต ะธะฝััััะผะตะฝัั:

* **Go** โ ะฒะตััะธั 1.18 ะธะปะธ ะฒััะต
* **Bash** โ ะธะปะธ ัะพะฒะผะตััะธะผัะน ัะตัะผะธะฝะฐะป
* **Docker** โ ะดะปั Kafka ะธ PostgreSQL
* **Python 3** โ ะดะปั ะทะฐะฟััะบะฐ frontend-ัะตัะฒะตัะฐ

---

## ๐ Go-ะทะฐะฒะธัะธะผะพััะธ

| ะะฐะบะตั                                                 | ะะฐะทะฝะฐัะตะฝะธะต                                 |
| ----------------------------------------------------- | ------------------------------------------ |
| `github.com/google/uuid`                              | ะะตะฝะตัะฐัะธั ัะฝะธะบะฐะปัะฝัั ID (UUID) ะดะปั ะทะฐะบะฐะทะพะฒ |
| `github.com/confluentinc/confluent-kafka-go/v2/kafka` | Kafka-ะบะปะธะตะฝั ะดะปั Go                        |
| `github.com/caarlos0/env/v10`                         | ะะฐััะธะฝะณ ะฟะตัะตะผะตะฝะฝัั ะพะบััะถะตะฝะธั ะฒ ััััะบัััั   |
| `github.com/joho/godotenv`                            | ะะฐะณััะทะบะฐ ะฟะตัะตะผะตะฝะฝัั ะธะท `.env` ัะฐะนะปะพะฒ       |
| `github.com/gorilla/mux`                              | HTTP-ัะพััะตั                                |
| `github.com/lib/pq`                                   | PostgreSQL-ะดัะฐะนะฒะตั ะดะปั Go                  |

---

## ๐ค ะะฐะฟััะบ ัะผัะปััะพัะฐ ัะพะพะฑัะตะฝะธะน Kafka

```bash
source scripts/env.sh
go run cmd/producer/emulator_producer.go
```

๐ ะะพัะปะต ะทะฐะฟััะบะฐ ะผะพะถะฝะพ ะฟะพัะผะพััะตัั ัะพะพะฑัะตะฝะธั ะฒ Kafka UI โ `Dashboard` โ `Topics`.

---

## ๐ฅ ะะฐะฟััะบ ะพัะฝะพะฒะฝะพะณะพ ะฟัะธะปะพะถะตะฝะธั

```bash
source scripts/env.sh
go run cmd/consumer/main.go
```

ะัะธะผะตั ะทะฐะฟัะพัะฐ ัะตัะตะท `curl`:

```bash
curl http://localhost:8080/order/<order_uid> | jq
```

---

## ๐ ะะฐะฟััะบ frontend-ะธะฝัะตััะตะนัะฐ

```bash
cd frontend
python3 -m http.server 8081
```

ะะฝัะตััะตะนั ะฑัะดะตั ะดะพัััะฟะตะฝ ะฟะพ ะฐะดัะตัั: [http://localhost:8081](http://localhost:8081)

---

## ๐ API

| ะะตัะพะด | ะญะฝะดะฟะพะธะฝั             | ะะฟะธัะฐะฝะธะต                |
| ----- | -------------------- | ----------------------- |
| GET   | `/order/<order_uid>` | ะะพะปััะตะฝะธะต ะดะฐะฝะฝัั ะทะฐะบะฐะทะฐ |

---
